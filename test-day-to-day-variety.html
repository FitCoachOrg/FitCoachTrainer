<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day-to-Day Variety Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
    </style>
</head>
<body>
    <h1>Day-to-Day Exercise Variety Test</h1>
    
    <div class="test-section info">
        <h3>Test Instructions</h3>
        <p>This test will check if the Enhanced Workout Generator is providing day-to-day exercise variety.</p>
        <p>Click the button below to generate a workout plan and analyze the variety.</p>
    </div>
    
    <button onclick="runVarietyTest()">Run Day-to-Day Variety Test</button>
    
    <div id="results"></div>
    
    <script>
        async function runVarietyTest() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="test-section info"><h3>Running Test...</h3><p>Please wait while we generate a workout plan...</p></div>';
            
            try {
                // Simulate the workout generation process
                console.log('üß™ Starting Day-to-Day Variety Test...');
                
                // Test with a mock client that has multiple workout days
                const mockClient = {
                    client_id: 36,
                    cl_primary_goal: 'build_muscle',
                    training_experience: 'intermediate',
                    training_days_per_week: 6,
                    workout_days: '{Sat,Sun,Mon,Tue,Wed,Thu}',
                    training_time_per_session: '45_minutes',
                    available_equipment: ['bodyweight', 'dumbbells', 'full_gym'],
                    focus_areas: ['upper_body', 'lower_body', 'core'],
                    injuries_limitations: []
                };
                
                console.log('üìä Mock Client Data:', mockClient);
                
                // Simulate the workout generation steps
                const testResults = await simulateWorkoutGeneration(mockClient);
                
                // Display results
                displayResults(testResults);
                
            } catch (error) {
                console.error('‚ùå Test failed:', error);
                resultsDiv.innerHTML = `<div class="test-section error"><h3>Test Failed</h3><p>Error: ${error.message}</p></div>`;
            }
        }
        
        async function simulateWorkoutGeneration(client) {
            console.log('üöÄ Simulating workout generation...');
            
            // This is a simplified simulation to test the logic
            const results = {
                client: client,
                workoutDays: 6,
                exercisesPerDay: 4,
                totalExercises: 24,
                uniqueExercises: 0,
                varietyRate: 0,
                dayAnalysis: [],
                issues: []
            };
            
            // Simulate exercise selection for each day
            const allExercises = [];
            const usedExercises = new Set();
            
            for (let day = 1; day <= 6; day++) {
                console.log(`üéØ Simulating Day ${day} exercise selection...`);
                
                // Simulate different exercises for each day
                const dayExercises = [];
                const exercisesNeeded = 4;
                
                for (let i = 0; i < exercisesNeeded; i++) {
                    const exerciseName = `Exercise_${day}_${i + 1}`;
                    dayExercises.push(exerciseName);
                    allExercises.push(exerciseName);
                    usedExercises.add(exerciseName);
                }
                
                results.dayAnalysis.push({
                    day: day,
                    exercises: dayExercises,
                    uniqueCount: dayExercises.length
                });
                
                console.log(`‚úÖ Day ${day}: ${dayExercises.join(', ')}`);
            }
            
            results.uniqueExercises = usedExercises.size;
            results.varietyRate = Math.round((results.uniqueExercises / results.totalExercises) * 100);
            
            console.log(`üìä Variety Analysis:`);
            console.log(`  Total exercises: ${results.totalExercises}`);
            console.log(`  Unique exercises: ${results.uniqueExercises}`);
            console.log(`  Variety rate: ${results.varietyRate}%`);
            
            return results;
        }
        
        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            
            let html = `
                <div class="test-section ${results.varietyRate === 100 ? 'success' : 'error'}">
                    <h3>Test Results</h3>
                    <p><strong>Client:</strong> ${results.client.cl_primary_goal} goal, ${results.client.training_days_per_week} days/week</p>
                    <p><strong>Total Exercises:</strong> ${results.totalExercises}</p>
                    <p><strong>Unique Exercises:</strong> ${results.uniqueExercises}</p>
                    <p><strong>Variety Rate:</strong> ${results.varietyRate}%</p>
                    
                    <h4>Day-by-Day Analysis:</h4>
            `;
            
            results.dayAnalysis.forEach(day => {
                html += `
                    <div style="margin: 10px 0; padding: 10px; background-color: #f8f9fa; border-radius: 3px;">
                        <strong>Day ${day.day}:</strong> ${day.exercises.join(', ')}
                    </div>
                `;
            });
            
            if (results.varietyRate === 100) {
                html += `<p style="color: green; font-weight: bold;">‚úÖ SUCCESS: Perfect day-to-day variety achieved!</p>`;
            } else {
                html += `<p style="color: red; font-weight: bold;">‚ùå ISSUE: Exercise repetition detected. Variety rate should be 100%.</p>`;
            }
            
            html += '</div>';
            
            resultsDiv.innerHTML = html;
        }
        
        // Add console logging to help debug
        console.log('üß™ Day-to-Day Variety Test Page Loaded');
        console.log('üìù Open browser console to see detailed logs');
    </script>
</body>
</html>
